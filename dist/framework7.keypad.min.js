/**
 * Framework7 Plugin Keypad 2.0.0
 * Keypad plugin extends Framework7 with additional custom keyboards
 * http://framework7.io/plugins/
 *
 * Copyright 2014-2019 [object Object]
 *
 * Released under the MIT License
 *
 * Released on: December 6, 2019
 */
!function(e,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define(a):e.Framework7Keypad=a()}(this,function(){"use strict";var l;return{name:"keypad",install:function(){l=function(e){return function(h){function f(e,a){h.call(this,a,[e]);var t=e.utils,r=e.$,n=e.request,p=this;p.app=e;var l,s,o,u=t.extend({on:{}},e.params.keypad);if(p.params=t.extend(u,a),p.params.containerEl&&0===(l=r(p.params.containerEl)).length)return p;if(!p.params.buttons||0===p.params.buttons.length){var i=p.params,c=i.dotCharacter,d=i.dotButton;"numpad"===p.params.type?p.params.buttons=[{html:'<span class="keypad-button-number">1</span><span class="keypad-button-letters"></span>',value:1},{html:'<span class="keypad-button-number">2</span><span class="keypad-button-letters">ABC</span>',value:2},{html:'<span class="keypad-button-number">3</span><span class="keypad-button-letters">DEF</span>',value:3},{html:'<span class="keypad-button-number">4</span><span class="keypad-button-letters">GHI</span>',value:4},{html:'<span class="keypad-button-number">5</span><span class="keypad-button-letters">JKL</span>',value:5},{html:'<span class="keypad-button-number">6</span><span class="keypad-button-letters">MNO</span>',value:6},{html:'<span class="keypad-button-number">7</span><span class="keypad-button-letters">PQRS</span>',value:7},{html:'<span class="keypad-button-number">8</span><span class="keypad-button-letters">TUV</span>',value:8},{html:'<span class="keypad-button-number">9</span><span class="keypad-button-letters">WXYZ</span>',value:9},{html:d?'<span class="keypad-button-number">'+c+"</span>":"",value:d?c:void 0,dark:!0,cssClass:d?"":"keypad-dummy-button"},{html:'<span class="keypad-button-number">0</span>',value:0},{html:'<i class="icon icon-keypad-delete"></i>',cssClass:"keypad-delete-button",dark:!0}]:"calculator"===a.type&&(p.params.buttons=[{html:'<span class="keypad-button-number">C</span>',value:"C",dark:!0},{html:'<span class="keypad-button-number">±</span>',value:"±",dark:!0},{html:'<span class="keypad-button-number">%</span>',value:"%",dark:!0},{html:'<span class="keypad-button-number">÷</span>',value:"÷",cssClass:"calc-operator-button"},{html:'<span class="keypad-button-number">7</span>',value:7},{html:'<span class="keypad-button-number">8</span>',value:8},{html:'<span class="keypad-button-number">9</span>',value:9},{html:'<span class="keypad-button-number">×</span>',value:"×",cssClass:"calc-operator-button"},{html:'<span class="keypad-button-number">4</span>',value:4},{html:'<span class="keypad-button-number">5</span>',value:5},{html:'<span class="keypad-button-number">6</span>',value:6},{html:'<span class="keypad-button-number">-</span>',value:"-",cssClass:"calc-operator-button"},{html:'<span class="keypad-button-number">1</span>',value:1},{html:'<span class="keypad-button-number">2</span>',value:2},{html:'<span class="keypad-button-number">3</span>',value:3},{html:'<span class="keypad-button-number">+</span>',value:"+",cssClass:"calc-operator-button"},{html:'<span class="keypad-button-number">0</span>',value:0,cssClass:"keypad-button-double"},{html:'<span class="keypad-button-number">.</span>',value:c},{html:'<span class="keypad-button-number">=</span>',value:"=",cssClass:"calc-operator-button calc-operator-button-equal"}])}function v(){p.open()}function m(e){e.preventDefault()}function y(e){var a=r(e.target);p.isPopover()||p.opened&&(a.closest('[class*="backdrop"]').length||(s&&0<s.length?a[0]!==s[0]&&0===a.closest(".sheet-modal, .keypad-modal").length&&p.close():0===r(e.target).closest(".sheet-modal, .keypad-modal").length&&p.close()))}return p.params.inputEl&&(s=r(p.params.inputEl)),o=(o=p.params.view?p.params.view:s&&s.length?s.parents(".view").length&&s.parents(".view")[0].f7View:e.views.get(s))||e.views.main,t.extend(p,{app:e,request:n,$containerEl:l,containerEl:l&&l[0],inline:l&&0<l.length,$inputEl:s,inputEl:s&&s[0],initialized:!1,opened:!1,view:o,url:p.params.url,calcValues:[],calcOperations:[],lastWasNumber:!1}),t.extend(p,{attachInputEvents:function(){p.$inputEl.on("touchend click",v),p.params.inputReadOnly&&p.$inputEl.on("focus mousedown",m)},detachInputEvents:function(){p.$inputEl.off("touchend click",v),p.params.inputReadOnly&&p.$inputEl.off("focus mousedown",m)},attachHtmlEvents:function(){e.on("touchend click",y)},detachHtmlEvents:function(){e.off("touchend click",y)}}),p.attachKeypadEvents=function(){var s=p.$el.find(".keypad-buttons");function e(e){var a=r(e.target);if(a.hasClass("keypad-button")||(a=a.parents(".keypad-button")),0!==a.length){var t=p.params.buttons[a.index()],n=t.value,l=p.value;"numpad"===p.params.type&&(void 0===l&&(l=""),a.hasClass("keypad-delete-button")?l=l.substring(0,l.length-1):void 0!==n&&("."===n&&0<=l.indexOf(".")&&(n=""),l+=n),void 0!==l&&p.setValue(l)),"calculator"===p.params.type&&(p.calculator(t.value),s.find(".calc-operator-active").removeClass("calc-operator-active"),a.hasClass("calc-operator-button")&&!a.hasClass("calc-operator-button-equal")&&a.addClass("calc-operator-active")),p.emit("local::buttonClick keypadButtonClick",p,t),t.onClick&&t.onClick(p,t)}}s.on("touchend click",e),p.detachKeypadEvents=function(){s.off("touchend click",e)}},s&&s.length&&(s[0].f7Keypad=f),l&&l.length&&(l[0].f7Keypad=f),p.init(),p}return h&&(f.__proto__=h),((f.prototype=Object.create(h&&h.prototype)).constructor=f).prototype.initInput=function(){var e=this;e.$inputEl&&e.params.inputReadOnly&&e.$inputEl.prop("readOnly",!0)},f.prototype.isPopover=function(){var e=this,a=e.app,t=e.modal,n=e.params;if("sheet"===n.openIn)return!1;if(t&&"popover"!==t.type)return!1;if(!e.inline&&e.inputEl){if("popover"===n.openIn)return!0;if(a.device.ios)return!!a.device.ipad;if(768<=a.width)return!0}return!1},f.prototype.calculator=function(e){var n=this,l="+ - = × ÷ ± %".split(" ");function a(){for(var e="",a=0;a<n.calcOperations.length;a+=1){var t=n.calcOperations[a];a===n.calcOperations.length-1&&0<=l.indexOf(t)||t&&("."===t&&(t=0),e+=(""+t.toString()).replace("×","*").replace("÷","/"))}e=e.replace(/--/g,"+"),n.setValue(eval.call(window,e))}if(n.value||(n.value=0),"C"===e)return n.setValue(0),n.calcValues=[],void(n.calcOperations=[]);if(0<=[0,1,2,3,4,5,6,7,8,9,"."].indexOf(e)){if("."===e&&n.lastWasNumber&&0<=n.value.toString().indexOf("."))return;0<=l.indexOf(n.calcValues[n.calcValues.length-1])?n.setValue(e):n.setValue(n.value?""+n.value+e:e),n.lastWasNumber=!0}if(0<=l.indexOf(e))if("±"===e){if("."===n.value)return;n.setValue(-1*n.value),n.lastWasNumber=!0}else if("%"===e){if(n.calcOperations[n.calcOperations.length-2]){var t=n.value/100;n.setValue(n.calcOperations[n.calcOperations.length-2]*t)}n.lastWasNumber=!0}else{var s=n.calcOperations[n.calcOperations.length-1];if("="===e){if("="===n.calcOperations[n.calcOperations.length-1]){if(n.calcOperations.length<2)return;n.calcOperations.pop();var r=n.calcOperations[n.calcOperations.length-2],p=n.calcOperations[n.calcOperations.length-1];n.calcOperations.push(r),n.calcOperations.push(p)}else n.calcOperations.push(n.value);n.calcOperations.push("="),a()}else 0<=["-","+","×","÷","="].indexOf(s)?("="===s&&(n.calcOperations=[n.value,e]),0<=["-","+","×","÷"].indexOf(s)&&(n.lastWasNumber?0<=["-","+"].indexOf(s)&&0<=["×","÷"].indexOf(e)?(n.calcOperations.push(n.value),n.calcOperations.push(e)):(n.calcOperations.push(n.value),n.calcOperations.push(e),a()):n.calcOperations[n.calcOperations.length-1]=e)):(n.calcOperations.push(n.value),n.calcOperations.push(e),a());n.lastWasNumber=!1}"±"!==e&&"%"!==e&&n.calcValues.push(e)},f.prototype.formatValue=function(e){return this.params.formatValue?this.params.formatValue.call(this,e):e},f.prototype.setValue=function(e){this.updateValue(e)},f.prototype.getValue=function(){return this.value},f.prototype.updateValue=function(e){var a=this;a.value=e,a.params.valueMaxLength&&a.value.length>a.params.valueMaxLength&&(a.value=a.value.substring(0,a.params.valueMaxLength)),a.$inputEl&&0<a.$inputEl.length&&(a.$inputEl.val(a.formatValue(a.value)),a.$inputEl.trigger("change")),a.emit("local::change keypadChange",a,a.value)},f.prototype.renderButtons=function(){for(var e,a,t="",n=0;n<this.params.buttons.length;n+=1)e="keypad-button",(a=this.params.buttons[n]).dark&&(e+=" keypad-button-dark"),a.cssClass&&(e+=" "+a.cssClass),t+='<span class="'+e+'">'+(a.html||"")+"</span>";return t},f.prototype.renderToolbar=function(){var e=this;return e.params.renderToolbar?e.params.renderToolbar.call(e,e):('\n        <div class="toolbar">\n          <div class="toolbar-inner">\n            <div class="left"></div>\n            <div class="right">\n              <a href="#" class="link sheet-close popover-close">'+e.params.toolbarCloseText+"</a>\n            </div>\n          </div>\n        </div>\n      ").trim()},f.prototype.renderSheet=function(){var e=this;if(e.params.renderSheet)return e.params.renderSheet.call(e,e);var a=e.params,t=a.cssClass,n=a.toolbar;return'\n        <div class="sheet-modal keypad keypad-sheet keypad-type-'+e.params.type+" "+(t||"")+'">\n          '+(n?e.renderToolbar():"")+'\n          <div class="sheet-modal-inner keypad-buttons">\n            '+e.renderButtons()+"\n          </div>\n        </div>\n      "},f.prototype.renderPopover=function(){var e=this;if(e.params.renderPopover)return e.params.renderPopover.call(e,e);var a=e.params,t=a.cssClass,n=a.toolbar;return('\n        <div class="popover keypad-popover">\n          <div class="popover-inner">\n            <div class="keypad keypad-type-'+e.params.type+" "+(t||"")+'">\n              '+(n?e.renderToolbar():"")+'\n              <div class="keypad-buttons">\n                '+e.renderButtons()+"\n              </div>\n            </div>\n          </div>\n        </div>\n      ").trim()},f.prototype.renderInline=function(){var e=this;if(e.params.renderInline)return e.params.renderInline.call(e,e);var a=e.params,t=a.cssClass,n=a.toolbar;return'\n        <div class="keypad keypad-inline keypad-type-'+e.params.type+" "+(t||"")+'">\n          '+(n?e.renderToolbar():"")+'\n          <div class="keypad-buttons">\n            '+e.renderButtons()+"\n          </div>\n        </div>\n      "},f.prototype.render=function(){var e=this,a=e.params;if(a.render)return a.render.call(e);if(!e.inline){var t=a.openIn;if("auto"===t&&(t=e.isPopover()?"popover":"sheet"),"popover"===t)return e.renderPopover();if("sheet"===t)return e.renderSheet()}return e.renderInline()},f.prototype.onOpen=function(){var e=this,a=e.initialized,t=e.$el,n=e.app,l=e.$inputEl,s=e.inline,r=e.value,p=e.params;e.opened=!0,e.attachKeypadEvents(),a?r&&e.setValue(r):r?e.setValue(r):p.value&&e.setValue(p.value),!s&&l.length&&"md"===n.theme&&l.trigger("focus"),e.initialized=!0,t&&t.trigger("keypad:open",e),l&&l.trigger("keypad:open",e),e.emit("local::open keypadOpen",e)},f.prototype.onOpened=function(){var e=this;e.$el&&e.$el.trigger("keypad:opened",e),e.$inputEl&&e.$inputEl.trigger("keypad:opened",e),e.emit("local::opened keypadOpened",e)},f.prototype.onClose=function(){var e=this,a=e.app;e.$inputEl&&"md"===a.theme&&e.$inputEl.trigger("blur"),e.detachKeypadEvents&&e.detachKeypadEvents(),e.$el&&e.$el.trigger("keypad:close",e),e.$inputEl&&e.$inputEl.trigger("keypad:close",e),e.emit("local::close keypadClose",e)},f.prototype.onClosed=function(){var e=this;e.opened=!1,e.inline||e.app.utils.nextTick(function(){e.modal&&e.modal.el&&e.modal.destroy&&(e.params.routableModals||e.modal.destroy()),delete e.modal}),e.$el&&e.$el.trigger("keypad:closed",e),e.$inputEl&&e.$inputEl.trigger("keypad:closed",e),e.emit("local::closed keypadClosed",e)},f.prototype.open=function(){var e,a=this,t=a.app,n=a.opened,l=a.inline,s=a.$inputEl,r=a.params;if(!n){if(l)return a.$el=t.$(a.render()),(a.$el[0].f7Keypad=a).$containerEl.append(a.$el),a.onOpen(),void a.onOpened();var p=r.openIn;"auto"===p&&(p=a.isPopover()?"popover":"sheet");var o=a.render(),u={targetEl:s,scrollToEl:a.params.scrollToInput?s:void 0,content:o,backdrop:"sheet"!==p,on:{open:function(){a.modal=this,a.$el="popover"===p?this.$el.find(".keypad"):this.$el,(a.$el[0].f7Keypad=a).onOpen()},opened:function(){a.onOpened()},close:function(){a.onClose()},closed:function(){a.onClosed()}}};a.params.routableModals?a.view.router.navigate({url:a.url,route:(e={path:a.url},e[p]=u,e)}):(a.modal=t[p].create(u),a.modal.open())}},f.prototype.close=function(){var e=this,a=e.opened,t=e.inline;if(a)return t?(e.onClose(),void e.onClosed()):void e.modal.close()},f.prototype.init=function(){var e=this;if(e.initInput(),e.inline)return e.open(),void e.emit("local::init keypadInit",e);!e.initialized&&e.params.value&&e.setValue(e.params.value),e.$inputEl&&e.attachInputEvents(),e.params.closeByOutsideClick&&e.attachHtmlEvents(),e.emit("local::init keypadInit",e)},f.prototype.destroy=function(){var e=this;if(!e.destroyed){var a=e.$el;e.emit("local::beforeDestroy keypadBeforeDestroy",e),a&&a.trigger("keypad:beforedestroy",e),e.close(),e.$inputEl&&e.detachInputEvents(),e.params.closeByOutsideClick&&e.detachHtmlEvents(),a&&a.length&&delete e.$el[0].f7Keypad,e.app.utils.deleteProps(e),e.destroyed=!0}},f}(e)}(this.Class),this.Keypad=l},params:{keypad:{type:"numpad",openIn:"auto",inputEl:null,containerEl:null,value:null,valueMaxLength:null,dotButton:!0,dotCharacter:".",buttons:[],closeByOutsideClick:!0,scrollToInput:!0,inputReadOnly:!0,onlyInPopover:!1,cssClass:null,toolbar:!0,toolbarCloseText:"Done",routableModals:!0,view:null,url:"select/",renderToolbar:null,renderPopover:null,renderSheet:null,renderInline:null,render:null}},create:function(){var t=this,n=t.$;t.keypad={create:function(e){return new l(t,e)},get:function(e){if(void 0===e&&(e=".keypad"),e instanceof l)return e;var a=n(e);return 0!==a.length?a[0].f7Keypad:void 0},destroy:function(e){void 0===e&&(e=".keypad");var a=t.keypad.get(e);if(a&&a.destroy)return a.destroy()},close:function(e){void 0===e&&(e=".keypad");var a=n(e);if(0!==a.length){var t=a[0].f7Keypad;!t||t&&!t.opened||t.close()}}}},on:{pageInit:function(e){var l=e.app.$,s=e.app;e.$el.find('input[type="numpad"], input[type="calculator"]').each(function(e,a){var t=l(a),n={inputEl:a,type:t.attr("type"),value:t.val()||0};t.attr("maxlength")&&(n.valueMaxLength=t.attr("maxlength")),s.keypad.create(s.utils.extend(n,t.dataset()))})},pageBeforeRemove:function(t){t.$el.find('input[type="numpad"], input[type="calculator"]').each(function(e,a){t.app.keypad.destroy(a)})}}}});
//# sourceMappingURL=framework7.keypad.min.js.map
